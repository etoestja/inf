\documentclass[a4paper]{article}
\usepackage[a4paper, left=5mm, right=5mm, top=5mm, bottom=5mm]{geometry}
%\geometry{paperwidth=210mm, paperheight=2000pt, left=5pt, top=5pt}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{indentfirst}
\usepackage{tikz} %Рисование автоматов
\usetikzlibrary{automata,positioning,arrows,trees}
\usepackage{amsmath}
\usepackage{enumerate}
\usepackage[makeroom]{cancel} % зачеркивание
\usepackage{multicol,multirow} %Несколько колонок
\usepackage{hyperref}
\usepackage{tabularx}
\usepackage{amsfonts}
\usepackage{amssymb}
\DeclareMathOperator*{\argmin}{arg\,min}
\usepackage{wasysym}
\title{Алгоритмы и модели вычислений.\\Задание 1: Алгоритмы и оценка сложности}
\date{задано 2014.02.13}
\author{Сергей~Володин, 272 гр.}
\newcommand{\matrixl}{\left|\left|}
\newcommand{\matrixr}{\right|\right|}
% названия автоматов  (rubtsov)
\def\A{{\cal A}}
\def\B{{\cal B}}
\def\C{{\cal C}}

%+= и -=, иначе разъезжаются...
\newcommand{\peq}{\mathrel{+}=}
\newcommand{\meq}{\mathrel{-}=}
\newcommand{\deq}{\mathrel{:}=}
\newcommand{\plpl}{\mathrel{+}+}

% пустое слово  (rubtsov)
\def\eps{\varepsilon}

% регулярные языки  (rubtsov)
\def\REG{{\mathsf{REG}}}
\def\CFL{{\mathsf{CFL}}}
\def\eqdef{\overset{\mbox{\tiny def}}{=}}
\newcommand{\niton}{\not\owns}

%FIRST & FOLLOW (rubtsov)
\def\first{\mathrm{ FIRST} }
\def\follow{\mathrm{ FOLLOW} }

% LL LR (rubtsov)
\def\LL{{\mathrm{LL}}}
\def\LR{{\mathrm{LR}}}

\newcounter{rowItemCount}
\newcounter{subRowItemCount}
\newcommand\rowItem{
    \setcounter{subRowItemCount}{0}
    \arabic{rowItemCount}.\addtocounter{rowItemCount}{1}}
\newcommand\subRowItem{
    \addtocounter{subRowItemCount}{1}
    \addtocounter{rowItemCount}{-1}
    \arabic{rowItemCount}.\arabic{subRowItemCount}.\addtocounter{rowItemCount}{1}}
    
\newcommand{\smalll}[1]{\overline{\overline{#1}}}
\newcommand{\smallo}{\bar{\bar{o}}}

\begin{document}
\maketitle
\subsection*{(каноническое) Задача 1}
$f(n) \eqdef \sum\limits_{i=1}^n\frac{1}{i}$, $g(n)=\log n$. Доказать: $f=\Theta(g)\Leftrightarrow \begin{cases}
f=O(g)\\
g=O(f)\\
\end{cases}\Leftrightarrow \begin{cases}
\exists C_1,n_1\colon\forall n\geqslant n_1\hookrightarrow f(n)\leqslant C_1 g(n) & (1)\\
\exists C_2,n_2\colon\forall n\geqslant n_2\hookrightarrow g(n)\leqslant C_2 f(n) & (2)\\
\end{cases}$
\begin{enumerate}
\item \label{c1_0} Докажем утверждение: пусть $f(n),g(n)\colon \exists n_0,C>0\colon \forall n\geqslant n_0\hookrightarrow \underbrace{f(n+1)-f(n)}_{\Delta_f(n)}\leqslant C_1\underbrace{g(n+1)-g(n)}_{\Delta_g(n)}$. Тогда $f=O(g)$. Действительно, выберем $C_2>0$ таким образом, что $f(n_0)\leqslant C_2g(n_0)$ (всегда можно сделать). Возьмем $C$ из определения $O$ как $C=\max(C_1,C_2)$. Докажем по индукции $\forall n\geqslant n_0\hookrightarrow f(n)\leqslant Cg(n)$:\begin{enumerate}
\item $f(n_0)\leqslant C_2g(n_0)\leqslant Cg(n_0)\blacksquare$
\item Пусть $f(n)\leqslant Cg(n)$. Докажем для $n+1$: по условию $\Delta_f(n)=f(n+1)-f(n)\leqslant C_1(g(n+1)-g(n))\leqslant C(g(n+1)-g(n))$. Перегруппируем, получим $f(n+1)-Cg(n+1)\leqslant f(n)-Cg(n)\overset{\mbox{предп.}}{\leqslant} 0$, т.е. $f(n+1)\leqslant Cg(n+1)\blacksquare$
\end{enumerate}
\item Докажем $(1)$. \begin{enumerate}
\item \label{c1_1_1} $\varangle \Delta_f(n)\eqdef f(n+1)-f(n)=\frac{1}{n+1}\leqslant \frac{1}{n}$. 
\item \label{c1_1_2} $\varangle \Delta_g(n)\eqdef g(n+1)-g(n)=\log(n+1)-\log n=\log\frac{n+1}{n}=\log(1+\frac{1}{n})=\frac{1}{n}+\smallo(\frac{1}{n})=\boxed{*}$, $n\to\infty$. Но по определению $\smallo$ $\exists n_1\colon\forall n\geqslant n_1\hookrightarrow \boxed{*}\geqslant \frac{1}{n}(1-\frac{1}{2})=\frac{1}{2}\frac{1}{n}$. Тогда $\frac{1}{n}\leqslant 2\boxed{*}=2(g(n+1)-g(n))$
\item Получаем $\Delta_f(n)=f(n+1)-f(n)\overset{\ref{c1_1_1}}{\leqslant} \frac{1}{n}\overset{\ref{c1_1_2}}{\leqslant} 2(g(n+1)-g(n))=2\Delta_g(n)$, и по $\ref{c1_0}$ получаем $f=O(g)$.
\end{enumerate}
\item Докажем $(2)$. \begin{enumerate}
\item \label{c1_2_1} $\varangle \Delta_f(n)=\frac{1}{n+1}$. Докажем, что это больше, чем $\frac{1}{2}\frac{1}{n}$: $\frac{1}{n+1}-\frac{1}{2}\frac{1}{n}=\frac{2n-n-1}{2n(n+1)}=\frac{n-1}{2n(n+1)}\geqslant 0$, $n\geqslant 1$. Итак, $\Delta_f(n)\geqslant \frac{1}{2}\frac{1}{n}$
\item \label{c1_2_2} $\ref{c1_1_2}\Rightarrow \Delta_g(n)=\frac{1}{n}+\smallo(\frac{1}{n})\leqslant \frac{1}{n}(1+\frac{1}{2})$ при $n\geqslant n_2>1$. Значит, $\frac{3}{2}\frac{1}{n}\geqslant\Delta_g(n)$
\item $\Delta_g(n)\overset{\ref{c1_2_2}}{\leqslant}\frac{3}{2}\frac{1}{n}\overset{\ref{c1_2_1}}{\leqslant}\frac{3}{2}\cdot 2\cdot \Delta_f(n)$ при $n\geqslant n_2$, и по $\ref{c1_0}$ получаем $g=O(f)$.
\end{enumerate}
\end{enumerate}
\subsection*{(каноническое) Задача 2}
\subsection*{(каноническое) Задача 3}
\begin{enumerate}
\item $T(n)=9T(\frac{n}{3})+f(n)$, $f(n)=\Theta(n^2\log n)$.
\begin{enumerate}
\item Докажем, что теорема неприменима. $a=9,b=3\Rightarrow \log_b a=\log_3 9=2$.
\begin{enumerate}
\item Если $\exists \eps>0\colon f(n)=O(n^{2-\eps})$, то $\exists C>0\exists n_0$, для $n\geqslant n_0$ получим $f(n)/n^{2-\varepsilon}\leqslant C>0$, то есть $n^2\log n/n^{2-\eps}\equiv n^\varepsilon\log n\leqslant C$, что неверно (функция неограничена сверху).
\item Если $f=\Theta(n^2)$, то $\exists n_0\exists C>0\colon f\leqslant Cn^2$ для $n\geqslant n_0$, и $\log n\leqslant C$, что неверно (функция неограничена сверху).
\item Если $\exists \eps>0\colon f=\Omega(n^{2-\eps})$, то $\exists n_0\colon\forall n\geqslant n_0\hookrightarrow f\geqslant Cn^{2+\eps}$, и $\log n\geqslant Cn^\eps$, откуда $\frac{\log^n}{n^\eps}\geqslant C>0$, что неверно, так как $\forall\eps>0\hookrightarrow\lim\limits_{n\to\infty}\frac{\log n}{n^\eps}=+0$
\end{enumerate}
\item Найдем ответ через дерево рекурсии. В корне ($i=0$) выполняется $n^2\log n$ операций, у каждой вершины 9 детей, на уровне $i+1$ $n_{i+1}=n_i/3$. У листьев (по индукции по высоте дерева) $1=n_h=\frac{n}{3^h}$, поэтому высота дерева {\em (не считая корня)} $h=\log_3n$. Найдем суммарное время:
$$T(n)=\Theta(n^2\log n+9(\frac{n}{3})^2\log\frac{n}{3}+9^2(\frac{n}{3^2})^2\log\frac{n}{3^2}+...+9^{h-1}(\frac{n}{3^{h-1}})^2\log\frac{n}{3^{h-1}})+9^hT(1)$$
Найдем сумму в аргументе $\Theta$: $\sum\limits_{i=0}^{h-1}9^i(\frac{n}{3^i})^2\log\frac{n}{3^i}=n^2\sum\limits_{i=0}^{h-1}(\log n-i\log 3)=n^2\log n(h-1)-n^2\frac{h-1}{2}\log 3=\newline=n^2\log n(\log_3n-1)-n^2\frac{\log_3n-1}{2}\log 3=n^2\log^2n-n^2\log n-n^2\log n+Cn^2=\Theta(n^2\log^2 n)$.\newline
Найдем $9^hT(1)=C9^{\log_3 n}=Cn^2$. Имеем $T(n)=\Theta(n^2\log^2n)+Cn^2=\boxed{\Theta(n^2\log^2n)}$
\end{enumerate}
\item $T(n)=16T(\frac{n}{4})+f(n)$, $f(n)=\Theta(n^2)$. $a=16,\,b=4$. Применим второй пункт Теоремы: $\Theta(n^{\log_b a})\equiv\Theta(n^2)$, поэтому $f(n)=\Theta(n^{\log_b a})$, и отсюда $T(n)=\boxed{\Theta(n^2\log n)}$.
\item $T(n)=4T(\frac{n}{2})+\Theta(\frac{n^2\sqrt{n}}{\log^2n})$. $a=4,\,b=2\Rightarrow\log_b a=2$. Возьмем $\eps=\frac{1}{4}$ и применим третий пункт Теоремы: $f(n)\overset{?}{=}\Omega(n^{2+\eps})$. Рассмотрим $\frac{f(n)}{n^{2+\eps}}=\frac{n^2\sqrt{n}}{n^2n^\eps\log^2 n}=\frac{n^{\frac{1}{2}-\eps}}{\log^2 n}=\frac{n^{1/4}}{\log^2 n}=(\frac{n^{1/8}}{\log_n})^2\overset{n\to\infty}{\longrightarrow}+\infty$, поэтому $\exists C>0\exists n_0>0\colon \forall n\geqslant n_0\hookrightarrow f(n)\geqslant C n^{2+\eps}$. Значит, оценка верна, и по теореме получаем $T(n)=\boxed{\Theta(\frac{n^{5/2}}{\log^2n})}$
\end{enumerate}
Сравним первую и вторую функции: $\frac{n^2\log^2 n}{n^2\log n}=\log n\overset{n\to\infty}{\longrightarrow}+\infty$, поэтому первый алгоритм хуже. Сравним вторую и третью функции: $\frac{n^2\sqrt{n}}{\log^2n}\frac{1}{n^2\log n}=\frac{n^{1/2}}{\log^3 n}=(\frac{n^{1/6}}{\log n})^3\overset{n\to\infty}{\longrightarrow}+\infty$, поэтому третий алгоритм хуже.
Ответ: $\boxed{\mbox{второй алгоритм}}$.
\subsection*{(каноническое) Задача 4}
\subsection*{(каноническое) Задача 5}
\subsection*{Задача 1}
\begin{enumerate}
\item $T(n)=2T(\frac{n}{3})+\Theta(n^2)$
\end{enumerate}
\subsection*{Задача 2}
\subsection*{Задача 3}
\end{document}