\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{graphicx}
\usepackage{indentfirst}
\usepackage{amsmath}
\usepackage{amsfonts}
\title{Задание от 2013.02.15}
\author{С.~Е.~Володин, 272 гр.}
\date{}
\begin{document}
\maketitle
\paragraph{Задача 1.} Строка $\tilde{S}$ в указанном массиве будет расположена перед всеми суффиксами, которые ей равны, т.к. её индекс~--- $1$~--- меньше. Поэтому условие эквивалентно следующему: посчитать количество $k$ суффиксов строки $\tilde{S}$, которые меньше самой строки. Ответом будет $k+1$. Нумерация элементов строки начинается с $0$: $\tilde{S}[0]=s_1$.

Посчитаем z-функцию \begin{math}z(x):\overline{0,n-1}\rightarrow\mathbb{N}\cup\{0,\infty\}\end{math} для префикса $\tilde{S}$ длины $n$. Если при расчете сравниваются символы с индексом, большим $2n$, то $z(x)\stackrel{\mathrm{def}}{=}\infty$, т.к. в таком случае префикс элемента $x$ целиком совпадает со строкой $\tilde{S}$, т.е.  $z(x)$ больше любого конечного числа. {\em Время и память: $O(n)$}

По определению z-функции $\forall x\in\overline{0,n-1}\hookrightarrow\tilde{S}[x+z(x)]\neq\tilde{S}[z(x)]$, т.к. в противном случае z-функция посчитана неверно (можно увеличить на $1$). Так как суффиксы бесконечны, то результат сравнения $\tilde{S}_{x+1}<\tilde{S}_1$ совпадает с результатом сравнения $\tilde{S}[x+z(x)]<\tilde{S}[z(x)]$, т.к., по определению $z(x)$, все символы с номерами $(x,\dots,x+z(x)-1)$ и $(0,\dots,z(x)-1)$ совпадают, а следующие~--- различны.

Поэтому $k=|\{x\in\overline{0,n-1}:z(x)\neq\infty\wedge\tilde{S}[x+z(x)]<\tilde{S}[z(x)]\}|$. Для того, чтобы посчитать это значение, достаточно цикла из $n$ итераций. {\em Время: $O(n)$, память: $O(1)$}.
\paragraph{Задача 2.} Нумерация элементов строки начинается с $0$. $|s|$~--- длина строки $s$. Пусть $p$~--- период $s$. Построим z-функцию для нее. Тогда $z(|p|)=|s|-|p|$, т.е. суффикс, начинающийся на втором повторении $p$ совпадает с началом $s$.
%Также $z(x)>=x$ выполнено, т.к. иначе бы символы, следующие за $z(x)-1$ и$$
Поэтому условие \begin{equation}\label{cr}z(x)=|s|-x\end{equation} является необходимым для того, чтобы префикс $p$ длины $x$ был ее периодом. Период обладает минимальной длиной среди всех префиксов, для которого это условие выполнено. Поэтому рассмотрим первый префикс $p$ длины $x$, для которого выполнено (\ref{cr}) и докажем, что он является периодом, т. е. строка имеет вид $s=p^k\,q$, где $q$~--- префикс $p$.

Пусть $z(x)\leq x$. Тогда (из определения z-функции) первые $z(x)$ символов $p$ расположены после конца $p$ в исходной строке, т.е. строка состоит из периода $p$ и его первых символов.

Пусть $z(x)>x$. Тогда $(s[0],\dots,s[x-1])=(s[x],\dots,s[2x-1])$ из определения z-функции.

Далее продолжим это рассуждение по индукции по количеству $m$ повторов $p$: Пусть в $s$ содержится $m$ повторов $p$.

Если $z(x)\geq mx$, то, по определению z-функции,\newline $(s[(m-1)x],\dots,s[mx-1])=(s[mx],\dots,s[(m+1)x-1])$, т.е. в строке содержится $(m+1)$-й повтор.

В противном случае рассуждение аналогично первому случаю базы индукции.

То есть, необходимым и достаточным условием для того, чтобы префикс $p$ длины менее $|s|$ строки $s$ был ее периодом, является условие ($\ref{cr}$).

Алгоритм следующий: построим z-функцию за $O(n)$ времени и памяти. После циклом найдем первый индекс $x$, для которого выполнено (\ref{cr}) за $O(n)$ времени и $O(1)$ памяти. Если такого индекса не найдено, выберем $p=s, k=1, q=\emptyset$, т.к. префиксов, для которых выполнено (\ref{cr}), по длине меньших $|s|$ нет.
\end{document}
